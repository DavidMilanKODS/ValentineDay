<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Will You Be My Valentine? üíù</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@400;700&family=Dancing+Script:wght@400;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Playfair Display', serif;
            background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 50%, #ffecd2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        .container {
            text-align: center;
            background: rgba(255, 255, 255, 0.85);
            padding: 60px 80px;
            border-radius: 40px;
            box-shadow: 0 25px 70px rgba(0, 0, 0, 0.15);
            max-width: 600px;
            width: 90%;
            position: relative;
            z-index: 10;
            animation: fadeIn 0.5s ease-in;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        h1 {
            font-size: 4em;
            color: #d63447;
            margin-bottom: 40px;
            text-shadow: 3px 3px 8px rgba(214, 52, 71, 0.2);
            font-family: 'Great Vibes', cursive;
        }

        .question {
            font-size: 2em;
            color: #5a3e36;
            margin-bottom: 40px;
            line-height: 1.5;
            font-family: 'Dancing Script', cursive;
            font-weight: 700;
        }

        .buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            padding: 18px 50px;
            font-size: 1.3em;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            font-family: 'Playfair Display', serif;
        }

        .yes-btn {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #ffecd2 100%);
            color: #8b4367;
        }

        .yes-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 25px rgba(255, 154, 158, 0.4);
        }

        .no-btn {
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
            color: #4a6fa5;
        }

        .no-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 25px rgba(161, 196, 253, 0.4);
        }

        .next-btn, .cancel-btn {
            padding: 15px 40px;
            font-size: 1.1em;
        }

        .next-btn {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #8b5a3c;
        }

        .cancel-btn {
            background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);
            color: #6a4c93;
        }

        .hidden {
            display: none;
        }

        .success-message {
            font-size: 4em;
            background: linear-gradient(135deg, #ff6b9d 0%, #c86dd7 50%, #ff6b9d 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 30px;
            animation: floatText 3s ease-in-out infinite, shimmer 3s ease-in-out infinite;
            font-family: 'Great Vibes', cursive;
            font-weight: 400;
            text-shadow: 0 0 30px rgba(255, 107, 157, 0.3);
            line-height: 1.4;
            letter-spacing: 2px;
            filter: drop-shadow(0 5px 15px rgba(255, 107, 157, 0.2));
        }

        @keyframes floatText {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes shimmer {
            0%, 100% {
                filter: drop-shadow(0 5px 15px rgba(255, 107, 157, 0.2)) brightness(1);
            }
            50% {
                filter: drop-shadow(0 8px 25px rgba(255, 107, 157, 0.4)) brightness(1.1);
            }
        }

        /* Success Screen Specific Styling */
        #successScreen .container,
        .success-screen-active .container {
            background: rgba(255, 255, 255, 0.25) !important;
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 255, 255, 0.4);
        }

        /* Fireworks Canvas */
        #fireworks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }

        /* Video Container */
        .video-container {
            margin-top: 20px;
        }

        video {
            max-width: 100%;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* File Upload Section (Admin) */
        .admin-upload {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            border: 2px dashed rgba(214, 52, 71, 0.3);
        }

        .admin-upload input[type="file"] {
            display: none;
        }

        .upload-label {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #8b5a3c;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-family: 'Playfair Display', serif;
            letter-spacing: 1px;
        }

        .upload-label:hover {
            background: linear-gradient(135deg, #fcb69f 0%, #ffecd2 100%);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(252, 182, 159, 0.4);
        }

        .upload-status {
            margin-top: 10px;
            color: #8b5a3c;
            font-size: 0.9em;
            font-family: 'Playfair Display', serif;
        }

        @media (max-width: 600px) {
            .container {
                padding: 40px 30px;
            }

            h1 {
                font-size: 2em;
            }

            .question {
                font-size: 1.4em;
            }

            button {
                padding: 15px 35px;
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <canvas id="fireworks"></canvas>

    <div class="container">
        <!-- Initial Question Screen -->
        <div id="initialScreen">
            <h1>üíù</h1>
            <div class="question">Will you be my Valentine?</div>
            <div class="buttons">
                <button class="yes-btn" onclick="handleInitialYes()">Yes</button>
                <button class="no-btn" onclick="startConfirmationSequence()">No</button>
            </div>
        </div>

        <!-- Success Screen with Fireworks -->
        <div id="successScreen" class="hidden">
            <div class="success-message">Thank you ‚ù§Ô∏è<br>I love you ‚ù§Ô∏è</div>
            <div class="video-container" style="margin-bottom: 20px;">
                <video id="thankYouVideo" autoplay loop muted style="max-width: 100%; max-height: 300px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);">
                    <source src="/mnt/user-data/uploads/Love_meme__template___Wholesome_meme_____shorts.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <div class="buttons">
                <button class="next-btn" onclick="stopFireworks()">Next</button>
                <button class="cancel-btn" onclick="stopFireworks()">Cancel</button>
            </div>
        </div>

        <!-- Confirmation Questions Screen -->
        <div id="confirmationScreen" class="hidden">
            <div class="question" id="confirmationQuestion"></div>
            <div class="buttons">
                <button class="yes-btn" onclick="handleConfirmationYes()">Yes</button>
                <button class="no-btn" onclick="handleConfirmationNo()">No</button>
            </div>
        </div>

        <!-- Final Video Screen -->
        <div id="videoScreen" class="hidden">
            <h1>üíï</h1>
            <div class="video-container">
                <video id="valentineVideo" controls autoplay>
                    <source id="videoSource" src="" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
        </div>

        <!-- Admin Upload Section -->
        <div class="admin-upload">
            <label for="videoUpload" class="upload-label">
                üìπ Admin: Upload Video
            </label>
            <input type="file" id="videoUpload" accept="video/*" onchange="handleVideoUpload(event)">
            <div class="upload-status" id="uploadStatus"></div>
        </div>
    </div>

    <script>
        // Confirmation questions array
        const confirmationQuestions = [
            "Are you sure?",
            "Really sure?",
            "Should we think about it once more?",
            "Final confirmation?"
        ];

        let currentQuestionIndex = 0;
        let uploadedVideoURL = null;

        // Show specific screen
        function showScreen(screenId) {
            document.getElementById('initialScreen').classList.add('hidden');
            document.getElementById('successScreen').classList.add('hidden');
            document.getElementById('confirmationScreen').classList.add('hidden');
            document.getElementById('videoScreen').classList.add('hidden');
            document.getElementById(screenId).classList.remove('hidden');
        }

        // Handle initial "Yes" button
        function handleInitialYes() {
            showScreen('successScreen');
            document.body.classList.add('success-screen-active');
            document.querySelector('.container').style.background = 'rgba(255, 255, 255, 0.25)';
            document.querySelector('.container').style.backdropFilter = 'blur(15px)';
            
            // Play the thank you video with audio
            const thankYouVideo = document.getElementById('thankYouVideo');
            if (thankYouVideo) {
                thankYouVideo.muted = false;
                thankYouVideo.play().catch(err => {
                    // If autoplay with sound fails, try unmuting after user interaction
                    console.log('Autoplay with audio blocked, unmuting:', err);
                });
            }
            
            startFireworks();
        }

        // Start confirmation sequence
        function startConfirmationSequence() {
            currentQuestionIndex = 0;
            displayConfirmationQuestion();
            showScreen('confirmationScreen');
        }

        // Display current confirmation question
        function displayConfirmationQuestion() {
            document.getElementById('confirmationQuestion').textContent = 
                confirmationQuestions[currentQuestionIndex];
        }

        // Handle "Yes" in confirmation questions
        function handleConfirmationYes() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < confirmationQuestions.length) {
                // Move to next confirmation question
                displayConfirmationQuestion();
            } else {
                // All confirmations completed, show video or final action
                if (uploadedVideoURL) {
                    document.getElementById('videoSource').src = uploadedVideoURL;
                    document.getElementById('valentineVideo').load();
                    showScreen('videoScreen');
                } else {
                    alert('Please upload a video first! (Admin feature)');
                    showScreen('initialScreen');
                }
            }
        }

        // Handle "No" in confirmation questions
        function handleConfirmationNo() {
            if (currentQuestionIndex === 0) {
                // First confirmation - go back to initial screen
                showScreen('initialScreen');
            } else {
                // Go to previous question
                currentQuestionIndex--;
                displayConfirmationQuestion();
            }
        }

        // Video upload handler
        function handleVideoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                // Revoke previous URL if exists
                if (uploadedVideoURL) {
                    URL.revokeObjectURL(uploadedVideoURL);
                }
                
                uploadedVideoURL = URL.createObjectURL(file);
                document.getElementById('uploadStatus').textContent = 
                    `‚úÖ Video uploaded: ${file.name}`;
            }
        }

        // Fireworks Animation
        let canvas, ctx, fireworks, particles;
        let animationId = null;

        function initFireworks() {
            canvas = document.getElementById('fireworks');
            ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            fireworks = [];
            particles = [];
        }

        function startFireworks() {
            initFireworks();
            animateFireworks();
            
            // Launch fireworks periodically
            fireworkInterval = setInterval(() => {
                fireworks.push(new Firework());
            }, 400);
        }

        function stopFireworks() {
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
            if (fireworkInterval) {
                clearInterval(fireworkInterval);
            }
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            document.body.classList.remove('success-screen-active');
            document.querySelector('.container').style.background = 'rgba(255, 255, 255, 0.85)';
            document.querySelector('.container').style.backdropFilter = 'blur(10px)';
            
            // Pause the thank you video
            const thankYouVideo = document.getElementById('thankYouVideo');
            if (thankYouVideo) {
                thankYouVideo.pause();
                thankYouVideo.currentTime = 0;
            }
            
            showScreen('initialScreen');
        }

        class Firework {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = canvas.height;
                this.targetY = Math.random() * canvas.height * 0.5;
                this.speed = 3;
                this.angle = -Math.PI / 2;
                this.gravity = 0.02;
                this.brightness = Math.random() * 30 + 60;
                // Romantic color palette: pinks, purples, golds, rose
                const romanticHues = [340, 350, 320, 280, 300, 45, 30, 15];
                this.hue = romanticHues[Math.floor(Math.random() * romanticHues.length)] + Math.random() * 20;
            }

            update() {
                this.y -= this.speed;
                this.speed -= this.gravity;

                if (this.speed <= 0) {
                    this.explode();
                    return false;
                }
                return true;
            }

            explode() {
                const particleCount = 100;
                for (let i = 0; i < particleCount; i++) {
                    particles.push(new Particle(this.x, this.y, this.hue));
                }
            }

            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                ctx.fillStyle = `hsl(${this.hue}, 100%, ${this.brightness}%)`;
                ctx.fill();
            }
        }

        class Particle {
            constructor(x, y, hue) {
                this.x = x;
                this.y = y;
                this.hue = hue;
                this.brightness = Math.random() * 30 + 60;
                this.angle = Math.random() * Math.PI * 2;
                this.speed = Math.random() * 6 + 2;
                this.friction = 0.95;
                this.gravity = 0.25;
                this.opacity = 1;
                this.decay = Math.random() * 0.02 + 0.01;
            }

            update() {
                this.speed *= this.friction;
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed + this.gravity;
                this.opacity -= this.decay;
                return this.opacity > 0;
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.opacity;
                
                // Add glow effect
                ctx.shadowBlur = 15;
                ctx.shadowColor = `hsl(${this.hue}, 100%, ${this.brightness}%)`;
                
                ctx.beginPath();
                ctx.arc(this.x, this.y, 2.5, 0, Math.PI * 2);
                ctx.fillStyle = `hsl(${this.hue}, 100%, ${this.brightness}%)`;
                ctx.fill();
                ctx.restore();
            }
        }

        function animateFireworks() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            fireworks = fireworks.filter(firework => {
                firework.update();
                firework.draw();
                return firework.speed > 0;
            });

            particles = particles.filter(particle => {
                const alive = particle.update();
                particle.draw();
                return alive;
            });

            animationId = requestAnimationFrame(animateFireworks);
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            if (canvas) {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
        });
    </script>
</body>
</html>
